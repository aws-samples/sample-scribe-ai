<form name="input">
  <div>
    {% if interview.questions|length > 0 %}
    <!-- list of all questions and answers -->
    <ul id="chat" class="list-unstyled">
      {% for question in interview.questions %}
      <li class="d-flex mb-4">
        <p></p>
        <div class="card">
          <div class="card-header d-flex p-3">
            <p class="fw-bold mb-0">Scribe AI</p>
          </div>
          <div class="card-body">
            <p class="mb-0">{{question.question|markdown}}</p>
          </div>
        </div>
      </li>
      {% if question.answer %}
      <li class="d-flex mb-4">
        <div
          class="card w-100 user-message"
          data-question-index="{{loop.index}}"
        >
          <div class="card-header d-flex p-3">
            <p class="fw-bold mb-0">You</p>
          </div>
          <div class="card-body">
            <p class="mb-0">{{question.answer|markdown}}</p>
          </div>
        </div>
        <p></p>
      </li>
      {% endif %} {% endfor %}
    </ul>
    {% endif %} {% if sources|length > 0 %}
    <div class="accordion mb-4">
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseOne"
            aria-expanded="false"
            aria-controls="collapseOne"
          >
            <b>Sources</b>
          </button>
        </h2>
        <div
          id="collapseOne"
          class="accordion-collapse collapse"
          data-bs-parent="#accordionExample"
        >
          <div class="accordion-body">
            <ul>
              {% for source in sources %}
              <li>
                <a href="{{source.url}}">{{source.name}}</a> ({{(source.score *
                100)|int}}%)
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
    <br />
    {% endif %}

    <!-- new question box without send button -->
    <div class="form-outline">
      <input type="hidden" name="interview_id" value="{{interview.id}}" />
      <div>
        <textarea
          id="speech-text-area"
          name="answer"
          class="form-control resizable-textarea"
          rows="8"
          placeholder="Type your response..."
          hx-trigger="keydown[key==='Enter'&&!shiftKey]"
          hx-on:keydown="(event.keyCode===13&&!event.shiftKey)?event.preventDefault():null"
          hx-post="/interview/answer"
          hx-target="#body"
          hx-indicator="#spinner"
          style="resize: vertical; min-height: 120px"
        ></textarea>
      </div>
    </div>
    <!-- Send Button -->
    <div class="d-flex justify-content-end align-items-center mt-4">
      <button
        id="send-message-btn"
        type="button"
        class="btn btn-primary"
        title="Send Message"
        hx-post="/interview/answer"
        hx-target="#body"
        hx-indicator="#spinner"
        hx-trigger="click"
      >
        <i class="fas fa-paper-plane me-1"></i>Send
      </button>
    </div>
  </div>
  <br />
  {% include "spinner.html" %}
</form>
